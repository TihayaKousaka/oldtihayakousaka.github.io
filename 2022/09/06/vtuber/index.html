<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="John Doe">
    
    
    
    
    
    
    <title>Hexo</title>
    <link href="http://example.com" rel="prefetch" />

    
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/aos.css">
<link rel="stylesheet" href="/css/style.css">

    
<script src="/js/jquery.min.js"></script>

    
<script src="/js/bootstrap.min.js"></script>

    
<script src="/js/aos.js"></script>

    
<script src="/js/highslide/highslide-full.min.js"></script>

    
<link rel="stylesheet" href="/js/highslide/highslide.css">

    <style type="text/css">
        @media (max-width: 768px) {
            body {
                background-color: #f0f0f0;
                background: url('/imgs/xsbg.gif');
                background-attachment: fixed;
            }
        }
    </style>
    
    <!--<script type="text/javascript">
      if (document.images) {
        var avatar = new Image();
        avatar.src = '/imgs/avatar.jpg'
        var previews = 'preview1.jpg,preview2.jpg,preview3.jpg,preview4.jpg'.split(',')
        var previewsPreLoad = []
        for(var i = 0; i < length; i++) {
          previewsPreLoad.push(new Image())
          previewsPreLoad[previewsPreLoad.length - 1].src = '/imgs/preview' + previews[i]
        }
      }
    </script>-->
<meta name="generator" content="Hexo 6.2.0"></head>
<body>
    <!-- 背景轮播图功能 -->
    <section class="hidden-xs">
    <ul class="cb-slideshow">
        <li><span>天若</span></li>
        <li><span>有情</span></li>
        <li><span>天亦老</span></li>
        <li><span>我为</span></li>
        <li><span>长者</span></li>
        <li><span>续一秒</span></li>
    </ul>
</section>
    <!-- 欧尼酱功能, 谁用谁知道 -->
    
    <div class="gal-menu gal-dropdown">
    <div class="circle" id="gal">
        <div class="ring">
            <a href="http://example.com" class="menuItem" style="left: 50%; top: 15%;">首页</a>
            
            <a class="menuItem" style="left: 80.3109%; top: 32.5%;">下一页</a>
            
            <a href="/archives" class="menuItem" style="left: 80.3109%; top: 67.5%;">归档</a>
            <a href="/about" class="menuItem" style="left: 50%; top: 85%;">关于</a>
            <a href="/message" class="menuItem" style="left: 19.6891%; top: 67.5%;">留言板</a>

            
            <a class="menuItem" style="left: 19.6891%; top: 32.5%;">上一页</a>
            
        </div>
        <audio id="audio" src="/imgs/oni.mp3"></audio>
    </div>
</div>
    
    <header class="navbar navbar-inverse" id="gal-header">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".bs-navbar-collapse"
                    aria-expanded="false">
                <span class="fa fa-lg fa-reorder"></span>
            </button>
            <a href="http://example.com">
                
                <style>
                    #gal-header .navbar-brand {
                        height: 54px;
                        line-height: 24px;
                        font-size: 28px;
                        opacity: 1;
                        background-color: rgba(0,0,0,0);
                        text-shadow: 0 0 5px #fff,0 0 10px #fff,0 0 15px #fff,0 0 20px #228DFF,0 0 35px #228DFF,0 0 40px #228DFF,0 0 50px #228DFF,0 0 75px #228DFF;
                    }
                </style>
                <!-- 这里使用文字(navbar_text or config.title) -->
                <div class="navbar-brand">塔弦岛OS</div>
                
            </a>
        </div>
        <div class="collapse navbar-collapse bs-navbar-collapse">
            <ul class="nav navbar-nav" id="menu-gal">
                
                
                <li class="">
                    <a href="/">
                        <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                
                
                <li class="">
                    <a href="/archives">
                        <i class="fa fa-archive"></i>归档
                    </a>
                </li>
                
                
                
                
                <li class="">
                    <a href="/categories">
                        <i class="fa fa-list"></i>分类
                    </a>
                </li>
                
                
                
                
                
                <li class="">
                    <a href="/tags">
                        <i class="fa fa-tags"></i>标签
                    </a>
                </li>
                
                
                
                
                <li class="">
                    <a href="/about">
                        <i class="fa fa-user"></i>关于我
                    </a>
                </li>
                
                
            </ul>
        </div>
    </div>
</header>
    <div id="gal-body">
        <div class="container">
            <div class="row">
                <div class="col-md-8 gal-right" id="mainstay">
                    
<article class="article well article-body" id="article">
    <div class="breadcrumb">
        <i class="fa fa-home"></i>
        <a href="http://example.com">Hexo</a>
        >
        <span></span>
    </div>
    <!-- 大型设备详细文章 -->
    <div class="hidden-xs">
        <div class="title-article">
            <h1>
                <a href="/2022/09/06/vtuber/"></a>
            </h1>
        </div>
        <div class="tag-article">
            
            <span class="label label-gal">
                <i class="fa fa-calendar"></i> 2022-09-06
            </span>
            
        </div>
    </div>
    <!-- 小型设备详细文章 -->
    <div class="visible-xs">
        <center>
            <div class="title-article">
                <h4>
                    <a href="/2022/09/06/vtuber/"></a>
                </h4>
            </div>
            <p>
                <i class="fa fa-calendar"></i> 2022-09-06
            </p>
            <p>
                
                
            </p>
        </center>
    </div>
    <div class="content-article">
        <h1 id="OpenVtuber-虚拟アイドル共享计划"><a href="#OpenVtuber-虚拟アイドル共享计划" class="headerlink" title="OpenVtuber-虚拟アイドル共享计划"></a>OpenVtuber-虚拟アイドル共享计划</h1><p align="center"><img src="https://s3.ax1x.com/2020/12/12/rVO3FO.gif" /></p>
<p align="center"><img src="https://s3.ax1x.com/2020/12/12/rZeXD0.gif" /></p>

<p><a target="_blank" rel="noopener" href="https://lgtm.com/projects/g/1996scarlet/OpenVtuber/context:python"><img src="https://img.shields.io/lgtm/grade/python/g/1996scarlet/OpenVtuber.svg?logo=lgtm&logoWidth=18" alt="Language grade: Python"></a><br><a href="LICENSE"><img src="https://badgen.net/github/license/1996scarlet/OpenVtuber" alt="License"></a><br><a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content_ECCV_2018/html/Seonwook_Park_Deep_Pictorial_Gaze_ECCV_2018_paper.html"><img src="https://badgen.net/badge/ECCV/2018/red" alt="ECCV"></a></p>
<p>OpenVtuber: An application of real-time face and gaze analyzation via deep nerual networks.</p>
<ul>
<li>Lightweight network architecture for low computing capability devices.</li>
<li>3D gaze estimation based on the whole face semantic informations.</li>
<li>The total framework is an upgradation of the <a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content_ECCV_2018/html/Seonwook_Park_Deep_Pictorial_Gaze_ECCV_2018_paper.html">[ECCV 2018]</a> version.</li>
<li>Drive MMD models through a single RGB camera.</li>
</ul>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><h3 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h3><ul>
<li>Python 3.6+</li>
<li><code>pip3 install -r requirements.txt</code></li>
<li>node.js and npm or <a target="_blank" rel="noopener" href="https://classic.yarnpkg.com/en/docs/install/#debian-stable">yarn</a></li>
<li><code>cd NodeServer &amp;&amp; yarn</code>  # install node modules</li>
</ul>
<h3 id="Socket-IO-Server"><a href="#Socket-IO-Server" class="headerlink" title="Socket-IO Server"></a>Socket-IO Server</h3><ul>
<li><code>cd NodeServer</code></li>
<li><code>yarn start</code></li>
<li>Open <code>http://127.0.0.1:6789/kizuna.html</code></li>
</ul>
<h3 id="Python-Client"><a href="#Python-Client" class="headerlink" title="Python Client"></a>Python Client</h3><ul>
<li><code>python3 vtuber_link_start.py &lt;your-video-path&gt;</code></li>
</ul>
<h2 id="Face-Detection"><a href="#Face-Detection" class="headerlink" title="Face Detection"></a>Face Detection</h2><p><a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content_CVPR_2020/html/Deng_RetinaFace_Single-Shot_Multi-Level_Face_Localisation_in_the_Wild_CVPR_2020_paper.html">RetinaFace: Single-stage Dense Face Localisation in the Wild</a> of <strong>CVPR 2020</strong>, is a practical single-stage <a target="_blank" rel="noopener" href="http://shuoyang1213.me/WIDERFACE/WiderFace_Results.html">SOTA</a> face detector. It is highly recommended to read the official repo <a target="_blank" rel="noopener" href="https://github.com/deepinsight/insightface/tree/master/RetinaFace">RetinaFace (mxnet version)</a>.</p>
<p>However, since the detection target of the face capture system is in the middle-close range, there is no need for complex pyramid scaling. We designed and published <a target="_blank" rel="noopener" href="https://github.com/1996scarlet/faster-mobile-retinaface">Faster RetinaFace</a> to trade off between speed and accuracy, which can reach 500~1000 fps on normal laptops.</p>
<table>
<thead>
<tr>
<th>Plan</th>
<th>Inference</th>
<th>Postprocess</th>
<th>Throughput Capacity (FPS)</th>
</tr>
</thead>
<tbody><tr>
<td>9750HQ+1660TI</td>
<td>0.9ms</td>
<td>1.5ms</td>
<td>500~1000</td>
</tr>
<tr>
<td>Jetson-Nano</td>
<td>4.6ms</td>
<td>11.4ms</td>
<td>80~200</td>
</tr>
</tbody></table>
<h2 id="Face-Alignment"><a href="#Face-Alignment" class="headerlink" title="Face Alignment"></a>Face Alignment</h2><p>In this project, we apply the facial landmarks for calculating head pose and slicing the eye regions for gaze estimation. Moreover, the mouth and eys status can be inferenced via these key points.</p>
<p><img src="https://s3.ax1x.com/2020/12/13/rm8az6.jpg" alt="Emotion"></p>
<p>The 2D pre-trained 106 landmarks model is provided by <a target="_blank" rel="noopener" href="https://github.com/deepinsight/insightface/tree/master/alignment/coordinateReg">insightface</a> repository, based on the coordinate regression face alignment algorithm. We refine this model into TFLite version with lower weights (4.7 MB), which can be found at <a href="PythonClient/weights/coor_2d106.tflite">here</a>. For checking the effectiveness of landmark detection, run the following command at <code>PythonClient</code> sub directory:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 service/TFLiteFaceAlignment.py &lt;your-video-path&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Head-Pose-Estimation"><a href="#Head-Pose-Estimation" class="headerlink" title="Head Pose Estimation"></a>Head Pose Estimation</h2><p>The Perspective-n-Point (PnP) is the problem of determining the 3D position and orientation (pose) of a camera from observations of known point features.<br>The PnP is typically formulated and solved linearly by employing <a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/1195992">lifting</a>, or <a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content_cvpr_2017/html/Ke_An_Efficient_Algebraic_CVPR_2017_paper.html">algebraically</a> or <a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/6126266">directly</a>.</p>
<p>Briefily, for head pose estimation, a set of pre-defined 3D facial landmarks and the corresponding 2D image projections need to be given. In this project, we employed the eyebrow, eye, nose, mouth and jaw landmarks in the <a target="_blank" rel="noopener" href="https://aifi.isr.uc.pt/Downloads.html">AIFI Anthropometric Model</a> as origin 3D feature points. The pre-defined vectors and mapping proctol can be found at <a href="PythonClient/weights/head_pose_object_points.npy">here</a>.</p>
<p align="center"><img src="docs/images/one.gif" /></p>

<p>We adopt <code>cv2.SolvePnP</code> API for calculating the rotation vector and transform vector. Run the following command at <code>PythonClient</code> sub directory for real-time head pose estimation:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 service/SolvePnPHeadPoseEstimation.py &lt;your-video-path&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Iris-Localization"><a href="#Iris-Localization" class="headerlink" title="Iris Localization"></a>Iris Localization</h2><p>Estimating human gaze from a single RGB face image is a challenging task.<br>Theoretically speaking, the gaze direction can be defined by pupil and eyeball center, however, the latter is unobservable in 2D images. Previous work of <a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content_ECCV_2018/html/Seonwook_Park_Deep_Pictorial_Gaze_ECCV_2018_paper.html">Swook, et al.</a> presents a method to extract the semantic information of iris and eyeball into the intermediate representation, which so called gazemaps, and then decode the gazemaps into euler angle through regression network.</p>
<p>Inspired by this, we propose a 3D semantic information based gaze estimation method. Instead of employing gazemaps as the intermediate representation, we estimate the center of the eyeball directly from the average geometric information of human gaze.</p>
<p><img src="https://s3.ax1x.com/2020/12/15/rKWPK0.jpg" alt="rKWPK0.jpg"></p>
<p>Our eye region landmark detection and iris localization models are more robust than the <a target="_blank" rel="noopener" href="https://github.com/swook/GazeML">original implementation</a>, which leads to the higher accuracy in more complex situations. The demo of iris localization can be run as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 service/TFLiteIrisLocalization.py &lt;your-video-path&gt;</span><br></pre></td></tr></table></figure>

<p>More details about 3D gaze estimation can be found at the <a target="_blank" rel="noopener" href="https://github.com/1996scarlet/Laser-Eye">Laser Eye</a> repository.</p>
<h2 id="Special-Thanks"><a href="#Special-Thanks" class="headerlink" title="Special Thanks"></a>Special Thanks</h2><ul>
<li><a target="_blank" rel="noopener" href="https://threejs.org/">threejs.org</a>: Applying Three.js WebGL Loader to render MMD models on web pages.</li>
<li><a target="_blank" rel="noopener" href="http://kizunaai.com/">kizunaai.com</a>: モデルは無料でご利用いただけます.</li>
</ul>
<h2 id="Citation"><a href="#Citation" class="headerlink" title="Citation"></a>Citation</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@InProceedings&#123;Park_2018_ECCV,</span><br><span class="line">      author = &#123;Park, Seonwook and Spurr, Adrian and Hilliges, Otmar&#125;,</span><br><span class="line">      title = &#123;Deep Pictorial Gaze Estimation&#125;,</span><br><span class="line">      booktitle = &#123;Proceedings of the European Conference on Computer Vision (ECCV)&#125;,</span><br><span class="line">      month = &#123;September&#125;,</span><br><span class="line">      year = &#123;2018&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@inproceedings&#123;Liu_2018_ECCV,</span><br><span class="line">      author = &#123;Liu, Songtao and Huang, Di and Wang, Yunhong&#125;,</span><br><span class="line">      title = &#123;Receptive Field Block Net for Accurate and Fast Object Detection&#125;,</span><br><span class="line">      booktitle = &#123;Proceedings of the European Conference on Computer Vision (ECCV)&#125;,</span><br><span class="line">      month = &#123;September&#125;,</span><br><span class="line">      year = &#123;2018&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>
</article>


                </div>
                <aside class="col-md-4 gal-left" id="sidebar">
    <!-- 此为sidebar的搜索框, 非搜索结果页面 -->
<aside id="sidebar-search">
    <div class="search hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <form class="form-inline clearfix" id="search-form" method="get"
              action="/search/index.html">
            <input type="text" name="s" class="form-control" id="searchInput" placeholder="搜索文章~" autocomplete="off">
            <button class="btn btn-danger btn-gal" type="submit">
                <i class="fa fa-search"></i>
            </button>
        </form>
    </div>
</aside>
    <aside id="sidebar-author">
    <div class="panel panel-gal" data-aos="flip-right" data-aos-duration="3000">
        <div class="panel-heading" style="text-align: center">
            <i class="fa fa-quote-left"></i>
            John Doe
            <i class="fa fa-quote-right"></i>
        </div>
        <div class="author-panel text-center">
            <img src="/imgs/avatar.jpg" width="140" height="140"
                 alt="个人头像" class="author-image">
            <p class="author-description"></p>
        </div>
    </div>
</aside>
    
    <aside id="sidebar-recent_comments">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-comments"></i>
            最新评论
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush"></ul>
    </div>
</aside>
    
    <!-- 要配置好leancloud才能开启此小工具 -->
    
    
    <aside id="sidebar-recent_posts">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-refresh"></i>
            近期文章
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush">
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2022/09/06/vtuber/"></a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2022/09/06/www/">はじめまして！</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2022/09/03/hello-world/">はじめまして！</a>
                </span>
            </li>
            
        </ul>
    </div>
</aside>
    
    
    <aside id="sidebar-rand_posts">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-refresh"></i>
            随机文章
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush">
            
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2022/09/03/hello-world/">はじめまして！</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2022/09/06/www/">はじめまして！</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2022/09/06/vtuber/"></a>
                </span>
            </li>
            
        </ul>
    </div>
</aside>
    
    
    <aside id="gal-sets">
        <div class="panel panel-gal hidden-xs" data-aos="fade-up" data-aos-duration="2000">
            <ul class="nav nav-pills pills-gal">

                
                <li>
                    <a href="/2022/09/06/vtuber/index.html#sidebar-tags" data-toggle="tab" id="tags-tab">热门标签</a>
                </li>
                
                
                <li>
                    <a href="/2022/09/06/vtuber/index.html#sidebar-friend-links" data-toggle="tab" id="friend-links-tab">友情链接</a>
                </li>
                
                
                <li>
                    <a href="/2022/09/06/vtuber/index.html#sidebar-links" data-toggle="tab" id="links-tab">个人链接</a>
                </li>
                
            </ul>
            <div class="tab-content">
                
                <div class="cloud-tags tab-pane nav bs-sidenav fade" id="sidebar-tags">
    
</div>
                
                
                <div class="friend-links tab-pane nav bs-sidenav fade" id="sidebar-friend-links">
    
    <li>
        <a href="http://kdays.net/days/" target="_blank">KDays Forum</a>
    </li>
    
    <li>
        <a href="http://www.gal123.com/" target="_blank">绅士导航♂</a>
    </li>
    
    <li>
        <a href="http://www.moe123.com/" target="_blank">萌导航</a>
    </li>
    
</div>
                
                
                <div class="links tab-pane nav bs-sidenav fade" id="sidebar-links">
    
    <li>
        <a href="https://github.com/TihayaKousaka/" target="_blank">Github</a>
    </li>
    
    <li>
        <a href="https://coding.net" target="_blank">Coding</a>
    </li>
    
    <li>
        <a href="https://www.zhihu.com" target="_blank">知乎</a>
    </li>
    
</div>
                
            </div>
        </div>
    </aside>
    
</aside>
            </div>
        </div>
    </div>
    <footer id="gal-footer">
    <div class="container">
        Copyright © 2022 John Doe Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;由塔弦岛的 <a href="https://github.com/TihayaKousaka" target="_blank">上坂茅羽耶制作</a>
    </div>
</footer>

<!-- 回到顶端 -->
<div id="gal-gotop">
    <i class="fa fa-angle-up"></i>
</div>

</body>

<script src="/js/activate-power-mode.js"></script>

<script>

    // 配置highslide
	hs.graphicsDir = '/js/highslide/graphics/'
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.lang.number = '共%2张图, 当前是第%1张';
    hs.addSlideshow({
      interval: 5000,
      repeat: true,
      useControls: true,
      fixedControls: "fit",
      overlayOptions: {
        opacity: 0.75,
        position: "bottom center",
        hideOnMouseOut: true
      }
    })

    // 初始化aos
    AOS.init({
      duration: 1000,
      delay: 0,
      easing: 'ease-out-back'
    });

</script>
<script>
	POWERMODE.colorful = 'true';    // make power mode colorful
	POWERMODE.shake = 'true';       // turn off shake
	// TODO 这里根据具体情况修改
	document.body.addEventListener('input', POWERMODE);
</script>
<script>
    window.slideConfig = {
      prefix: '/imgs/slide/background',
      ext: 'jpg',
      maxCount: '6'
    }
</script>

<script src="/js/hs.js"></script>
<script src="/js/blog.js"></script>



<script src="/js/oni.js"></script>




</html>